(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1569],{73067:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});var r=t(9116);let n=(0,r.Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},12741:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});var r=t(9116);let n=(0,r.Z)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},86856:function(e,s,t){Promise.resolve().then(t.bind(t,97778))},97778:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return Z}});var r=t(45610),n=t(41369),a=t(43654),i=t(97142),l=t(50044),c=t(57437),d=t(2265),o=t(61396),m=t.n(o),u=t(24033),x=t(93378),h=t(16357),f=t(99605),j=t(22048),p=t(74530);t(65640);var N=t(6141);t(78063);var y=t(73067),g=t(93505),b=t(67972),v=t(96142),w=t(12741),O=t(71738),S=t(64280),k=t(34289),M=t(71424);function Z(){var e,s,t,o,Z=(0,u.useRouter)(),T=(0,u.useSearchParams)(),A=(0,i._)((0,d.useState)(!1),2),E=A[0],_=A[1],C=(0,i._)((0,d.useState)(null),2),I=C[0],D=C[1],F=(0,i._)((0,d.useState)(!1),2),P=F[0],R=F[1],U=(0,i._)((0,d.useState)([]),2),B=U[0],Y=U[1],L=(0,i._)((0,d.useState)(!0),2),q=L[0],V=L[1],J=(0,i._)((0,d.useState)([{id:1,name:"Mini Idli with Sambar",description:"Soft steamed rice cakes with protein-rich lentil curry and coconut chutney",category:"Breakfast",price:"₹45",priceValue:45,quantity:2,image:"\uD83E\uDD5F"},{id:4,name:"Butter Chicken with Naan",description:"Mild creamy chicken curry with soft butter naan bread, kid-friendly spice level",category:"Lunch",price:"₹85",priceValue:85,quantity:1,image:"\uD83C\uDF5B"}]),1)[0];(0,d.useEffect)(function(){var e=null==T?void 0:T.get("checkout"),s=null==T?void 0:T.get("orderId");"true"===e&&s&&(_(!0),D(s)),z()},[T]);var z=(e=(0,r._)(function(){var e;return(0,l.Jh)(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,4,5]),V(!0),[4,fetch("/api/orders")];case 1:return[4,s.sent().json()];case 2:if((e=s.sent()).success&&e.data)Y(e.data);else throw Error(e.error||"Failed to load orders");return[3,5];case 3:return s.sent(),M.Am.error("Failed to load orders"),Y([]),[3,5];case 4:return V(!1),[7];case 5:return[2]}})}),function(){return e.apply(this,arguments)}),W=(s=(0,r._)(function(e,s){var t;return(0,l.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,fetch("/api/orders/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})];case 1:return[4,r.sent().json()];case 2:if((t=r.sent()).success)Y(function(t){return t.map(function(t){return t.id===e?(0,n._)({},t,s):t})}),M.Am.success("Order updated successfully");else throw Error(t.error||"Failed to update order");return[3,4];case 3:return r.sent(),M.Am.error("Failed to update order"),[3,4];case 4:return[2]}})}),function(e,t){return s.apply(this,arguments)}),H=(t=(0,r._)(function(e){var s,t;return(0,l.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,fetch("/api/orders/".concat(e,"/cancel"),{method:"DELETE",headers:{"Content-Type":"application/json"}})];case 1:return[4,r.sent().json()];case 2:if((s=r.sent()).success)Y(function(t){return t.map(function(t){var r;return t.id===e?(0,a._)((0,n._)({},t),{status:"cancelled",paymentStatus:(null===(r=s.data)||void 0===r?void 0:r.refundEligible)?"refunded":t.paymentStatus}):t})}),(null===(t=s.data)||void 0===t?void 0:t.refundEligible)?M.Am.success("Order cancelled successfully. Refund of ₹".concat(s.data.refundAmount," will be processed within 3-5 business days."),{duration:6e3}):M.Am.success("Order cancelled successfully. No refund applicable.");else throw Error(s.error||"Failed to cancel order");return[3,4];case 3:return r.sent(),M.Am.error("Failed to cancel order"),[3,4];case 4:return[2]}})}),function(e){return t.apply(this,arguments)}),G=function(e){M.Am.info("Viewing details for order ".concat(e))},K=function(){return J.reduce(function(e,s){return e+s.priceValue*s.quantity},0)},Q=(o=(0,r._)(function(){var e,s;return(0,l.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={studentId:"student_123",deliveryDate:new Date().toISOString().split("T")[0],mealPeriod:"lunch",orderItems:J.map(function(e){return{menuItemId:e.id,quantity:e.quantity}}),specialInstructions:""},[4,fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})];case 1:return[4,t.sent().json()];case 2:if((s=t.sent()).success)R(!0),M.Am.success("Order created successfully!"),setTimeout(function(){Z.push("/orders")},3e3);else throw Error(s.error||"Failed to create order");return[3,4];case 3:return t.sent(),M.Am.error("Failed to create order"),[3,4];case 4:return[2]}})}),function(){return o.apply(this,arguments)});return E&&I?(0,c.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-accent-50",children:[(0,c.jsx)("header",{className:"border-b bg-white/80 backdrop-blur",children:(0,c.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,c.jsx)("div",{className:"flex items-center justify-between",children:(0,c.jsxs)("div",{className:"flex items-center gap-4",children:[(0,c.jsx)(m(),{href:"/menu",children:(0,c.jsxs)(x.Button,{variant:"ghost",size:"sm",children:[(0,c.jsx)(y.Z,{className:"h-4 w-4 mr-2"}),"Back to Menu"]})}),(0,c.jsxs)("div",{className:"flex items-center gap-3",children:[(0,c.jsx)("div",{className:"h-10 w-10 rounded-xl bg-primary-500 flex items-center justify-center",children:(0,c.jsx)("span",{className:"text-white font-bold text-xl",children:"H"})}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"font-display font-bold text-2xl text-primary-600",children:"Checkout"}),(0,c.jsxs)("div",{className:"text-sm text-gray-600 -mt-1",children:["Order #",I]})]})]})]})})})}),(0,c.jsx)("main",{className:"container mx-auto px-4 py-8",children:P?(0,c.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,c.jsx)(h.Zb,{className:"border-0 shadow-soft text-center p-8",children:(0,c.jsxs)(h.aY,{children:[(0,c.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,c.jsx)(p.Z,{className:"h-8 w-8 text-green-600"})}),(0,c.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Order Confirmed!"}),(0,c.jsxs)("p",{className:"text-gray-600 mb-6",children:["Your order #",I," has been confirmed and sent to the kitchen."]}),(0,c.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:[(0,c.jsx)("h3",{className:"font-semibold text-green-800 mb-2",children:"What happens next?"}),(0,c.jsxs)("ul",{className:"text-sm text-green-700 space-y-1",children:[(0,c.jsx)("li",{children:"• Kitchen will start preparing your meal"}),(0,c.jsx)("li",{children:"• You'll receive updates on preparation progress"}),(0,c.jsx)("li",{children:"• Estimated ready time: 15-20 minutes"}),(0,c.jsx)("li",{children:"• You'll be notified when ready for pickup"})]})]}),(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"Redirecting to orders page..."})]})})}):(0,c.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,c.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,c.jsx)("div",{className:"lg:col-span-2",children:(0,c.jsxs)(h.Zb,{className:"border-0 shadow-soft",children:[(0,c.jsxs)(h.Ol,{children:[(0,c.jsxs)(h.ll,{className:"flex items-center",children:[(0,c.jsx)(g.Z,{className:"h-5 w-5 mr-2"}),"Order Summary"]}),(0,c.jsx)(h.SZ,{children:"Review your items before confirming the order"})]}),(0,c.jsxs)(h.aY,{children:[(0,c.jsx)("div",{className:"space-y-4",children:J.map(function(e){return(0,c.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,c.jsxs)("div",{className:"flex items-center gap-4",children:[(0,c.jsx)("div",{className:"text-3xl",children:e.image}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{className:"font-medium",children:e.name}),(0,c.jsx)("p",{className:"text-sm text-gray-600",children:e.description}),(0,c.jsx)(f.C,{variant:"outline",className:"mt-1",children:e.category})]})]}),(0,c.jsxs)("div",{className:"text-right",children:[(0,c.jsxs)("p",{className:"font-semibold",children:[e.price," \xd7 ",e.quantity]}),(0,c.jsxs)("p",{className:"text-sm text-gray-600",children:["₹",e.priceValue*e.quantity]})]})]},e.id)})}),(0,c.jsx)(j.Z,{className:"my-4"}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,c.jsxs)("span",{children:["Subtotal (",J.reduce(function(e,s){return e+s.quantity},0)," items)"]}),(0,c.jsxs)("span",{children:["₹",K()]})]}),(0,c.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,c.jsx)("span",{children:"Service Fee"}),(0,c.jsx)("span",{children:"₹0"})]}),(0,c.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,c.jsx)("span",{children:"Tax"}),(0,c.jsxs)("span",{children:["₹",Math.round(.05*K())]})]}),(0,c.jsx)(j.Z,{}),(0,c.jsxs)("div",{className:"flex justify-between font-bold text-lg",children:[(0,c.jsx)("span",{children:"Total"}),(0,c.jsxs)("span",{children:["₹",K()+Math.round(.05*K())]})]})]})]})]})}),(0,c.jsx)("div",{children:(0,c.jsxs)(h.Zb,{className:"border-0 shadow-soft",children:[(0,c.jsx)(h.Ol,{children:(0,c.jsxs)(h.ll,{className:"flex items-center",children:[(0,c.jsx)(b.Z,{className:"h-5 w-5 mr-2"}),"Order Details"]})}),(0,c.jsxs)(h.aY,{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Student Name"}),(0,c.jsx)("div",{className:"p-3 bg-gray-50 rounded-md text-gray-700",children:"Sarah Johnson"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class & Section"}),(0,c.jsx)("div",{className:"p-3 bg-gray-50 rounded-md text-gray-700",children:"8th Grade - Section A"})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,c.jsx)(v.Z,{className:"h-4 w-4 inline mr-1"}),"Pickup Location"]}),(0,c.jsx)("div",{className:"p-3 bg-gray-50 rounded-md text-gray-700",children:"School Cafeteria - Counter 2"})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,c.jsx)(w.Z,{className:"h-4 w-4 inline mr-1"}),"Contact Number"]}),(0,c.jsx)("div",{className:"p-3 bg-gray-50 rounded-md text-gray-700",children:"+91 98765 43210"})]}),(0,c.jsx)(j.Z,{}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,c.jsx)(O.Z,{className:"h-4 w-4 inline mr-1"}),"Payment Method"]}),(0,c.jsx)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsx)("span",{className:"text-green-800 font-medium",children:"School Wallet"}),(0,c.jsx)("span",{className:"text-green-600",children:"₹850 available"})]})})]}),(0,c.jsxs)(x.Button,{className:"w-full",size:"lg",onClick:Q,children:["Confirm Order - ₹",K()+Math.round(.05*K())]}),(0,c.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"By confirming, you agree to the school meal policy and terms"})]})]})})]})})})]}):(0,c.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-accent-50",children:[(0,c.jsx)("header",{className:"border-b bg-white/80 backdrop-blur",children:(0,c.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex items-center gap-4",children:[(0,c.jsx)(m(),{href:"/",children:(0,c.jsxs)(x.Button,{variant:"ghost",size:"sm",children:[(0,c.jsx)(y.Z,{className:"h-4 w-4 mr-2"}),"Back to Home"]})}),(0,c.jsxs)("div",{className:"flex items-center gap-3",children:[(0,c.jsx)("div",{className:"h-10 w-10 rounded-xl bg-primary-500 flex items-center justify-center",children:(0,c.jsx)("span",{className:"text-white font-bold text-xl",children:"H"})}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"font-display font-bold text-2xl text-primary-600",children:"Order Management"}),(0,c.jsx)("div",{className:"text-sm text-gray-600 -mt-1",children:"HASIVU Platform"})]})]})]}),(0,c.jsxs)(x.Button,{children:[(0,c.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"New Order"]})]})})}),(0,c.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,c.jsxs)("div",{className:"mb-8",children:[(0,c.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Meal Orders"}),(0,c.jsx)("p",{className:"text-gray-600",children:"Track and manage meal orders for students"})]}),!q&&(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,c.jsxs)(h.Zb,{className:"border-0 shadow-soft",children:[(0,c.jsx)(h.Ol,{className:"pb-3",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsx)(h.ll,{className:"text-sm font-medium text-gray-600",children:"Total Orders"}),(0,c.jsx)(g.Z,{className:"h-4 w-4 text-gray-600"})]})}),(0,c.jsxs)(h.aY,{className:"pt-0",children:[(0,c.jsx)("div",{className:"text-2xl font-bold",children:B.length}),(0,c.jsx)("p",{className:"text-xs text-gray-600",children:"All time"})]})]}),(0,c.jsxs)(h.Zb,{className:"border-0 shadow-soft",children:[(0,c.jsx)(h.Ol,{className:"pb-3",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsx)(h.ll,{className:"text-sm font-medium text-gray-600",children:"Delivered"}),(0,c.jsx)(p.Z,{className:"h-4 w-4 text-green-600"})]})}),(0,c.jsxs)(h.aY,{className:"pt-0",children:[(0,c.jsx)("div",{className:"text-2xl font-bold text-green-600",children:B.filter(function(e){return"delivered"===e.status}).length}),(0,c.jsxs)("p",{className:"text-xs text-gray-600",children:[B.length>0?Math.round(B.filter(function(e){return"delivered"===e.status}).length/B.length*100):0,"% completion rate"]})]})]}),(0,c.jsxs)(h.Zb,{className:"border-0 shadow-soft",children:[(0,c.jsx)(h.Ol,{className:"pb-3",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsx)(h.ll,{className:"text-sm font-medium text-gray-600",children:"Pending"}),(0,c.jsx)(N.Z,{className:"h-4 w-4 text-yellow-600"})]})}),(0,c.jsxs)(h.aY,{className:"pt-0",children:[(0,c.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:B.filter(function(e){return"pending"===e.status||"preparing"===e.status}).length}),(0,c.jsx)("p",{className:"text-xs text-gray-600",children:"In queue"})]})]})]}),(0,c.jsxs)("div",{className:"space-y-6",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Recent Orders"}),(0,c.jsx)("p",{className:"text-gray-600",children:"Manage and track your meal orders"})]}),(0,c.jsxs)(x.Button,{onClick:z,variant:"outline",size:"sm",children:[(0,c.jsx)(S.Z,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),q?(0,c.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,c.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),(0,c.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading orders..."})]}):0===B.length?(0,c.jsx)(h.Zb,{className:"border-0 shadow-soft",children:(0,c.jsxs)(h.aY,{className:"flex flex-col items-center justify-center py-12",children:[(0,c.jsx)(g.Z,{className:"h-12 w-12 text-gray-400 mb-4"}),(0,c.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No orders yet"}),(0,c.jsx)("p",{className:"text-gray-600 text-center mb-4",children:"You haven't placed any orders yet. Start by browsing our menu!"}),(0,c.jsx)(x.Button,{asChild:!0,children:(0,c.jsx)(m(),{href:"/menu",children:"Browse Menu"})})]})}):(0,c.jsx)("div",{className:"grid gap-6",children:B.map(function(e){return(0,c.jsx)(k.Fk,{order:e,onOrderUpdate:W,onOrderCancel:H,onViewDetails:G,showActions:!0},e.id)})})]})]})]})}},85606:function(e,s,t){"use strict";t.d(s,{z:function(){return i}});var r=t(2265),n=t(42210),a=t(51030),i=e=>{let s,t;let{present:i,children:c}=e,d=function(e){var s;let[t,n]=r.useState(),i=r.useRef(null),c=r.useRef(e),d=r.useRef("none"),o=e?"mounted":"unmounted",[m,u]=(s={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},r.useReducer((e,t)=>{let r=s[e][t];return r??e},o));return r.useEffect(()=>{let e=l(i.current);d.current="mounted"===m?e:"none"},[m]),(0,a.b)(()=>{let s=i.current,t=c.current,r=t!==e;if(r){let r=d.current,n=l(s);e?u("MOUNT"):"none"===n||s?.display==="none"?u("UNMOUNT"):t&&r!==n?u("ANIMATION_OUT"):u("UNMOUNT"),c.current=e}},[e,u]),(0,a.b)(()=>{if(t){let e;let s=t.ownerDocument.defaultView??window,r=r=>{let n=l(i.current),a=n.includes(CSS.escape(r.animationName));if(r.target===t&&a&&(u("ANIMATION_END"),!c.current)){let r=t.style.animationFillMode;t.style.animationFillMode="forwards",e=s.setTimeout(()=>{"forwards"===t.style.animationFillMode&&(t.style.animationFillMode=r)})}},n=e=>{e.target===t&&(d.current=l(i.current))};return t.addEventListener("animationstart",n),t.addEventListener("animationcancel",r),t.addEventListener("animationend",r),()=>{s.clearTimeout(e),t.removeEventListener("animationstart",n),t.removeEventListener("animationcancel",r),t.removeEventListener("animationend",r)}}u("ANIMATION_END")},[t,u]),{isPresent:["mounted","unmountSuspended"].includes(m),ref:r.useCallback(e=>{i.current=e?getComputedStyle(e):null,n(e)},[])}}(i),o="function"==typeof c?c({present:d.isPresent}):r.Children.only(c),m=(0,n.e)(d.ref,(t=(s=Object.getOwnPropertyDescriptor(o.props,"ref")?.get)&&"isReactWarning"in s&&s.isReactWarning)?o.ref:(t=(s=Object.getOwnPropertyDescriptor(o,"ref")?.get)&&"isReactWarning"in s&&s.isReactWarning)?o.props.ref:o.props.ref||o.ref),u="function"==typeof c;return u||d.isPresent?r.cloneElement(o,{ref:m}):null};function l(e){return e?.animationName||"none"}i.displayName="Presence"}},function(e){e.O(0,[7895,8293,7554,5906,5251,555,9222,1424,4289,2971,596,1744],function(){return e(e.s=86856)}),_N_E=e.O()}]);